# weatherin-app

## Задача: Умный сервис прогноза погоды
__Уровень сложности:__ Средний уровень сложности (видимо)

__Технологии:__ для реализациия сервиса использовался язык Python с применением методов из библиотеки Flask

__Интерфейс:__ Приложение имеет наипростейший веб-интерфейс в виде страницы с формой запроса, к которой можно получить доступ, перейдя по ссылке http://127.0.0.1:5000/weather после настройки и запуска программы. В веб-интерфейсе имеется форма, в которой необходимо указать какой-либо город и нажать на кнопку "Узнать погоду", после чего на странице появится информация о погодных условиях в указанном городе.

__Формат ответа:__ ответ отображается в виде текстового шаблона, в который подставляются данные, введённые пользователем в форму, и данные, полученные от [API](https://openweathermap.org/api):
* Погода в г. <город>
* по состоянию на <время и дата>
* Долгота: <дол> , широта: <шир>
* <температура>°С, <погодные условия>
* <иконка погодных условий, полученная от API>
* Ощущается как: <температура>°С
* Влажность: <влажность>%
* Ветер: <скорость ветра> м/с
  
## Алгоритм работы программы
1. Программа получает данные от пользователя через форму в веб-интерфейсе
    1. если пользователь пытается передать пустую строку, приложение уведомляет его об этом; произходит переход на начальный шаг
1. Программа принимает введённую строку и отправляет запрос в API, указывая эту строку в качестве одного из параметров запроса
1. От API приходит .json файл, который принимается программой
1. Программа проверяет поле этого файла, соответствующего коду ответа от API, на корректность
    1. если код говорит о том, что API не нашёл город, пользователю выводится информация об этом; происходит переход к начальному шагу
1. Полученный .json файл разбирается на переменные, которые передаются в шаблон отображаемой страницы, используемый в качестве ответа на запрос пользователя
## Пошаговая инструкция
### Настройка окружения
После скачивания проекта с GitHub необходимо произвести настройку окружения. Сделать это можно с помощью [miniconda](https://repo.anaconda.com/miniconda/), установив последнюю версию (на момент написания инструкции это py38_4.8.2). Далее необходимо открыть файл "environment.yml" в корневой папке проекта при помощи любого текстового редактора и изменить содержание полей ```name``` и ```prefix``` на полный путь к папке "venv" проекта. Необходимо убедиться, чтобы имена папок в полном пути не содержали пробелов. В установленном Anaconda Prompt необходимо запустить команду ```conda env create -f environment.yml```, которая создаст папку с окружением на основе изменённого файла.
### Запуск программы
Чтобы запустить программу, необходимо в системной командной строке или командной строке Анаконды выполнить команду ```python weatherin.py```, с учётом того, что команда запускается из папки с данным файлом. В командной строке можно будет увидеть следующее:
 * Serving Flask app "app" (lazy loading)
 * Environment: production
   WARNING: This is a development server. Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: ****
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
### Работа с интерфейсом
После запуска программы нужно открыть любой браузер и перейти по ссылке [http://127.0.0.1:5000/weather](http://127.0.0.1:5000/weather). На появившейся странице откроется форма для ввода названия города, погоду в котором хочется узнать. В эту форму можно вводить имена городов как на русском, так и на английском языке. Далее необходимо нажать на кнопку "Отправить". При указании города, о котором приложение ничего не знает, на странице появится сообщение об этом, и можно будет поменять название города.

По указанному (существующему) городу будет выдана информация на этой же странице о погодных условиях, таких как температура, влажность воздуха, скорость ветра, а также будет указана дополнительная информация о местонахождении и стране указанного города, с которой можно поиграться.
